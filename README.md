<h1 align="center">Welcome to Easy-Express's TypeORM Module 👋</h1>
<p>
  <a href="https://www.npmjs.com/package/@easy-express/typeorm" target="_blank">
    <img alt="Version" src="https://img.shields.io/npm/v/@easy-express/typeorm.svg">
  </a>
  <a href="#" target="_blank">
    <img alt="License: MIT" src="https://img.shields.io/badge/License-MIT-yellow.svg" />
  </a>
</p>

> A module that makes the use of TypeORM even easier by dynamically loading all entities inside a given directory before connecting to the database automatically using environment variables.

### 🏠 [Homepage](https://github.com/easy-express/typeorm#readme)

## Introduction

To start using TypeORM's awesome capabilities, simply attach a DatabaseModule to your EasyExpress server and you're good to go!

## Install

```sh
npm install @easy-express/typeorm
```

## Setup

First, add the following environment variables (you can use a .env file):

```sh
DB_HOST='HOST'
DB_NAME='DATABASE_NAME'
DB_PORT=DATABASE_PORT
DB_USER='DATABASE_USERNAME'
DB_PASSWD='DATABASE_PASSWORD'
#(For dialect, choose one of the following: )
DB_DIALECT= 'mysql' | 'mssql' | 'sqlite' | 'postgres' | 'mariadb' | 'mongodb'
```

Next, run the [generate_entities.sh](generate_entities.sh) script to generate the entities from your database using the credentials from your .env file. The entities will be placed into your src directory.

Finally, add the following compiler options to your tsconfig.json:

```js
{
  "compilerOptions": {
    // ...
    "strictPropertyInitialization": false,
    "emitDecoratorMetadata": true,
    "experimentalDecorators": true
    // ...
  }
}
```

## Usage

Create a new `DatabaseModule` and pass it a path to the directory containing all of the entities that were generated by the [generate_entities.sh](generate_entities.sh) script. Then, attach it to your `EasyExpressServer` -- the `DatabaseModule` automatically connects to the database using the environment variables you supplied during the setup process and lets you start using [TypeORM](https://typeorm.io/#/) right away.

### Example

```ts
import { EasyExpressServer } from '@easy-express/server';
import { DatabaseModule } from '@easy-express/typeorm';
import * as dotenv from 'dotenv';
import { getRepository } from 'typeorm';

// import entities here...
import { Balances } from './entities/Balances';

// load env vars from .env file
dotenv.config();

// create a new server
let server = new EasyExpressServer();

// define routes for your server

// ...

server.instance.get('/', (req, res) => {
  res.send('Hello World!');
});

// ...

// example of a route getting data from database using TypeORM
server.instance.get('/balances', async (req, res) => {
  // this works because the DatabaseModule establishes a connection to the database when you attach it to the server
  return getRepository(Balances)
    .find()
    .then((result) => {
      res.send(result);
    });
});

// ...

// attach a new database module to the server
server
  .attachModule(new DatabaseModule(__dirname + '/entities/'))
  .then(() => {
    // Start the server after you've attached the database module (this way you wait until the connection to the database is established before starting the server)
    server.start();
  })
  .catch((e) => {
    console.error(e);
    return e;
  });
```

## Author

👤 **Leonard Parisi**

- Website: leonardparisi.com
- Github: [@leonardparisi](https://github.com/leonardparisi)
- LinkedIn: [@https:\/\/www.linkedin.com\/in\/lenny-parisi\/](https://linkedin.com/in/lenny-parisi/)

## 🤝 Contributing

Contributions, issues and feature requests are welcome!<br />Feel free to check [issues page](https://github.com/easy-express/typeorm/issues). You can also take a look at the [contributing guide](https://github.com/easy-express/typeorm/blob/master/CONTRIBUTING.md).

## Show your support

Donations are greatly appreciated!

Bitcoin Wallet Address: 3PjDkxNznkx7HVmVdfSMYgGJeeJzoDH7e6
